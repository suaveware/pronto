var e=Object.defineProperty,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,n=(o,r,t)=>r in o?e(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t;import{r as a}from"./singletons-bb9012b7.js";import{a1 as s,a2 as i,a3 as c,C as d}from"./vendor-b5f9722e.js";const l=async function(e,o){return a.goto(e,o,[])};const f=()=>"undefined"!=typeof window,p=new s("pronto");p.version(2).stores({actions:"_id,order"});const b={READY:"ready",DONE:"done"},y=d([]),u=()=>p.actions.orderBy("order").filter((({state:e})=>e===b.READY)).toArray().then((e=>{console.log("dbActions",e),y.set(e)}));f()&&(console.log("db",p),p.actions.toCollection().toArray().then((e=>console.log("actions",e))),u());const v=f()&&{save:async e=>{var a=e,{_id:s}=a,d=((e,n)=>{var a={};for(var s in e)r.call(e,s)&&n.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&o)for(var s of o(e))n.indexOf(s)<0&&t.call(e,s)&&(a[s]=e[s]);return a})(a,["_id"]);const l=await p.actions.count();return s?p.actions.update(s,d).then(u):p.actions.add(((e,a)=>{for(var s in a||(a={}))r.call(a,s)&&n(e,s,a[s]);if(o)for(var s of o(a))t.call(a,s)&&n(e,s,a[s]);return e})({_id:i(),order:l,state:b.READY,createdAt:c.now().toMillis()},d)).then(u)},remove:({_id:e})=>p.actions.where({_id:e}).delete().then(u),reorder:async e=>{p.transaction("rw",p.actions,(async()=>e.map((({_id:e},o)=>p.actions.update(e,{order:o}))))).then(u)},refresh:u(),STATE:b};export{v as a,y as b,l as g};
